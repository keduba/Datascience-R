---
title: "HW 01 - Pet names"
author: "hugo baba"
date: "february 3, 2026"
output: github_document
---

## Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse)
library(openintro)
library(ggrepel)
library(ggimage)
```

## Exercises

### Exercise 1
```{r}
View(seattlepets)
nrow(seattlepets)
```

There are `r nrow(seattlepets)` pets in the dataset.

### Exercise 2

There are `r ncol(seattlepets)` columns in the dataset.

### Exercise 3


```{r most-common-names}
seattlepets %>%
  filter(!is.na(animal_name)) |> 
  count(animal_name, sort = TRUE)
```
The top three names are Lucy, Charlie and Luna.

### Exercise 4


```{r most-common-cat-dog-names}
seattlepets |> 
  group_by(species) |> 
  count(animal_name, sort = TRUE)
```

```{r}
seattlepets |>
  count(species, sort = TRUE)
```

```{r}
seattlepets |>
  group_by(species) |> 
  count(animal_name, sort = TRUE) |>
    slice_max(n, n = 20) 
  
```

### Exercise 5

```{r cat-dog-name-plot}
cats_n_dogs <- seattlepets |>
  filter(
    !is.na(animal_name),
    species %in% c("Cat", "Dog")) |>
  group_by(species) |> 
  count(animal_name, sort = TRUE)
```

```{r data-cats-dogs}
name_props <- cats_n_dogs |>
  mutate(props = n / sum(n))

 dogs_props <- name_props |>
  filter(species == "Dog") |> 
  rename(dog_prop = props) |> 
  slice(1:30)

 cats_props <- name_props |>
  filter(species == "Cat") |> 
  rename(cat_prop = props) |> 
  slice(1:30)
 
 all_props <- inner_join(cats_props, dogs_props, 
                         by = "animal_name") |> 
   select(animal_name, cat_prop, dog_prop)
 
```

### Exercise 6

```{r plot-cat-dog}
ggplot(all_props, aes(x = cat_prop, y = dog_prop)) +
  geom_abline(intercept = 0, color = COL["lgray", "full"],
              alpha = 0.8, linewidth = 1.5) +
  geom_text_repel(aes(label = animal_name),
                  segment.color = COL["lgray", "full"],
                  seed = 291252, max.iter = 9995) +
  geom_point(color = COL["blue", "full"], alpha = 0.8) +
  theme_minimal() +
  labs(x = "Proportion of cats", y = "Proportion of dogs") +
  xlim(0.002, 0.01) +
  ylim(0.002, 0.01) 
 
# geom_emoji(
#       image = "1f436", aes(x = 0.003, y = 0.009), size = 0.1) +
#   geom_emoji(
#       image = "1f431", aes(x = 0.009, y = 0.003), size = 0.1)
```


1. What names are more common for cats than dogs, those above the line or those below the line?

The names below the line are more common for cats than dogs. On the inverse, the names above the line are more common for dogs than they are for cats.

2. Is the relationship between the two variables (proportion of cats with a given name and proportion of dogs with a given name) positive or negative? What does this mean in context of the data?

The shape of the slope is positive indicating a positive relationship between the proportion of cats and dogs with a given name. That tells us that the data has a positive correlation.